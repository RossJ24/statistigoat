---
title: "StatistiGoat"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Load dataset
szn_stats <- read.csv("./Seasons_Stats.csv")
player_data <- read.csv("./player_data.csv")
szn_stats$PPG <- szn_stats$PTS/szn_stats$G
szn_stats$ORPG <- szn_stats$ORB/szn_stats$G
szn_stats$DRPG <- szn_stats$DRB/szn_stats$G
szn_stats$APG <- szn_stats$AST/szn_stats$G
szn_stats$BPG <- szn_stats$BLK/szn_stats$G
szn_stats$TPG <- szn_stats$TOV/szn_stats$G
szn_nums <- szn_stats
szn_nums$Tm <- NULL
szn_nums$Player<- NULL
szn_nums$Pos <- NULL

```


```{r}
# Extract era averages here

era1 <- szn_stats[which(szn_stats$Year <= 1965),]
era1 <- era1[!is.na(era1$PER), ]

era2 <- szn_stats[which(szn_stats$Year > 1965 & szn_stats$Year <= 1980),]

era3 <- szn_stats[which(szn_stats$Year > 1980 & szn_stats$Year <= 1990),]

era4 <- szn_stats[which(szn_stats$Year > 1990 & szn_stats$Year <= 2000),]

era5 <- szn_stats[which(szn_stats$Year > 2000 & szn_stats$Year <= 2010),]

era6 <- szn_stats[which(szn_stats$Year > 2010),]
```

```{r}

# Make boxplots of the variables we are considering to show why we need to adjust
#Points Boxplot
#boxplot(era1$PPG, era2$PPG, era3$PPG, era4$PPG, era5$PPG, era6$PPG, main ="PPG")
#boxplot(era1$APG, era2$APG, era3$APG, era4$APG, era5$APG, era6$APG, main = "APG")
#boxplot(era1$TPG, era2$TPG, era3$TPG, era4$TPG, era5$TPG, era6$TPG, main = "TPG")
#boxplot(era1$BPG, era2$BPG, era3$BPG, era4$BPG, era5$BPG, era6$BPG, main = "BPG")
#boxplot(era1$ORPG, era2$ORPG, era3$ORPG, era4$ORPG, era5$ORPG, era6$ORPG, main = "ORPG")
#boxplot(era1$DRPG, era2$DRPG, era3$DRPG, era4$DRPG, era5$DRPG, era6$DRPG, main = "DRPG")
```
*Why we have to cut out the bottom half of our data, there's a lot of statistical bums.*
```{r}

```


```{r}
library(dplyr)

get_player_avgs <- function(eradf){
  ret <- eradf %>% 
  group_by(Player) %>% 
  summarise(aPPG = mean(PPG, na.rm = T), aAPG = mean(APG, na.rm = T), aORPG = mean(ORPG, na.rm = T), aDRPG = mean(DRPG, na.rm = T), aBPG = mean(BPG, na.rm = T), aTPG = mean(TPG, na.rm = T), aTSP = mean(TS., na.rm = T), aPER = mean(PER, na.rm = T), aGR = mean(GR, na.rm = T))
  summarise(aPPG = mean(PPG, na.rm = T), aAPG = mean(APG, na.rm = T), aORPG = mean(ORPG, na.rm = T), aDRPG = mean(DRPG, na.rm = T), aBPG = mean(BPG, na.rm = T), aTPG = mean(TPG, na.rm = T), aTSP = mean(TS., na.rm = T), aPER = mean(PER, na.rm = T))
  return(ret)
}


era1pavgs <- get_player_avgs(era1)
era2pavgs <- get_player_avgs(era2)
era3pavgs <- get_player_avgs(era3)
era4pavgs <- get_player_avgs(era4)
era5pavgs <- get_player_avgs(era5)
era6pavgs <- get_player_avgs(era6)
szn_statspavgs <- get_player_avgs(szn_stats)
szn_statspavgs <- szn_statspavgs[-1, ]
```

```{r}
get_rid_of_bums <- function(df){
  tmp <- df[df$aPPG >= quantile(df$aPPG, prob= 0.95), ]
  return(tmp)
}

era1nb <- get_rid_of_bums(era1pavgs)
era2nb <- get_rid_of_bums(era2pavgs)
era3nb <- get_rid_of_bums(era3pavgs)
era4nb <- get_rid_of_bums(era4pavgs)
era5nb <- get_rid_of_bums(era5pavgs)
era6nb <- get_rid_of_bums(era6pavgs)
```

```{r}
boxplot(era1nb$aPPG, era2nb$aPPG, era3nb$aPPG, era4nb$aPPG, era5nb$aPPG, era6nb$aPPG, main ="PPG")
boxplot(era1nb$aAPG, era2nb$aAPG, era3nb$aAPG, era4nb$aAPG, era5nb$aAPG, era6nb$aAPG, main = "APG")
boxplot(era1nb$aTPG, era2nb$aTPG, era3nb$aTPG, era4nb$aTPG, era5nb$aTPG, era6nb$aTPG, main = "TPG")
boxplot(era1nb$aBPG, era2nb$aBPG, era3nb$aBPG, era4nb$aBPG, era5nb$aBPG, era6nb$aBPG, main = "BPG")
boxplot(era1nb$aORPG, era2nb$aORPG, era3nb$aORPG, era4nb$aORPG, era5nb$aORPG, era6nb$aORPG, main = "ORPG")
boxplot(era1nb$aDRPG, era2nb$aDRPG, era3nb$aDRPG, era4nb$aDRPG, era5nb$aDRPG, era6nb$aDRPG, main = "DRPG")
boxplot(era1nb$aTSP, era2nb$aTSP, era3nb$aTSP, era4nb$aTSP, era5nb$aTSP, era6nb$aTSP, main = "TSP")
boxplot(era1nb$aPER, era2nb$aPER, era3nb$aPER, era4nb$aPER, era5nb$aPER, era6nb$aPER, main = "PER")
```
```{r}
szn_stats_gr <- szn_stats

szn_stats_gr[is.na(szn_stats)] = 0 
#szn_stats

szn_stats_gr$GR <- (2.0 *szn_stats_gr$PPG) + ((4/5)*szn_stats_gr$DRPG) + szn_stats_gr$ORPG + (1.5 * szn_stats_gr$APG) + (szn_stats_gr$PER - (1.5 *szn_stats_gr$TPG)) + szn_stats_gr$BPG + (10.0 * szn_stats_gr$TS.)
szn_stats_gr$GR
test23 <- get_player_avgs(szn_stats_gr)
test69 <- get_rid_of_bums(test23)
plot(test23$aGR, test23$aPPG)
max(test69$aGR)
test69[which(test69$aGR == max(test69$aGR)),]
test69
```

