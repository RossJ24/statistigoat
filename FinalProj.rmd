---
title: "StatistiGoat"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Load dataset
szn_stats <- read.csv("./Seasons_Stats.csv")
player_data <- read.csv("./player_data.csv")
szn_stats$PPG <- szn_stats$PTS/szn_stats$G
szn_stats$ORPG <- szn_stats$ORB/szn_stats$G
szn_stats$DRPG <- szn_stats$DRB/szn_stats$G
szn_stats$APG <- szn_stats$AST/szn_stats$G
szn_stats$BPG <- szn_stats$BLK/szn_stats$G
szn_stats$TPG <- szn_stats$TOV/szn_stats$G
szn_stats_gr <- szn_stats
szn_stats_gr[is.na(szn_stats)] <- 0 
szn_stats$GR <- szn_stats_gr$GR
szn_stats_gr$GR <- (2.0 *szn_stats_gr$PPG) + ((4/5)*szn_stats_gr$DRPG) + szn_stats_gr$ORPG + (1.5 * szn_stats_gr$APG) + (szn_stats_gr$PER - (1.5 *szn_stats_gr$TPG)) + szn_stats_gr$BPG + (10.0 * szn_stats_gr$TS.)
szn_stats <- szn_stats_gr
szn_nums <- szn_stats
szn_nums$Tm <- NULL
szn_nums$Player<- NULL
szn_nums$Pos <- NULL


```


```{r}
# Extract era averages here

era1 <- szn_stats[which(szn_stats$Year <= 1965),]
era1 <- era1[!is.na(era1$PER), ]

era2 <- szn_stats[which(szn_stats$Year > 1965 & szn_stats$Year <= 1980),]

era3 <- szn_stats[which(szn_stats$Year > 1980 & szn_stats$Year <= 1990),]

era4 <- szn_stats[which(szn_stats$Year > 1990 & szn_stats$Year <= 2000),]

era5 <- szn_stats[which(szn_stats$Year > 2000 & szn_stats$Year <= 2010),]

era6 <- szn_stats[which(szn_stats$Year > 2010),]




```

```{r}
#making a new dataset for anova by era
firstera <- era1
firstera$Era <- 1

secondera <- era2
secondera$Era <- 2

thirdera <- era3
thirdera$Era <- 3

fourthera <- era4
fourthera$Era <- 4

fifthera <- era5
fifthera$Era <- 5

sixthera <- era6
sixthera$Era <- 6

library(dplyr)

alleras <- rbind(firstera, secondera, thirdera, fourthera, fifthera, sixthera)

alleras <- alleras[, c(3, 60, 61, 54)]
alleras <- alleras %>% 
  group_by(Player) %>% 
  summarise(aGR = mean(GR, na.rm = TRUE), era = round(mean(Era, na.rm = TRUE), digits = 0), aPPG = mean(PPG,na.rm =  T))

alleras <- alleras[-1, ]
```


```{r}

# Make boxplots of the variables we are considering to show why we need to adjust
#Points Boxplot
#boxplot(era1$PPG, era2$PPG, era3$PPG, era4$PPG, era5$PPG, era6$PPG, main ="PPG")
#boxplot(era1$APG, era2$APG, era3$APG, era4$APG, era5$APG, era6$APG, main = "APG")
#boxplot(era1$TPG, era2$TPG, era3$TPG, era4$TPG, era5$TPG, era6$TPG, main = "TPG")
#boxplot(era1$BPG, era2$BPG, era3$BPG, era4$BPG, era5$BPG, era6$BPG, main = "BPG")
#boxplot(era1$ORPG, era2$ORPG, era3$ORPG, era4$ORPG, era5$ORPG, era6$ORPG, main = "ORPG")
#boxplot(era1$DRPG, era2$DRPG, era3$DRPG, era4$DRPG, era5$DRPG, era6$DRPG, main = "DRPG")
```
*Why we have to cut out the bottom half of our data, there's a lot of statistical bums.*
```{r}

```


```{r}
library(dplyr)

get_player_avgs <- function(eradf){
  ret <- eradf %>% 
  group_by(Player) %>% 

  summarise(aPPG = mean(PPG, na.rm = T), aAPG = mean(APG, na.rm = T), aORPG = mean(ORPG, na.rm = T), aDRPG = mean(DRPG, na.rm = T), aBPG = mean(BPG, na.rm = T), aTPG = mean(TPG, na.rm = T), aTSP = mean(TS., na.rm = T), aPER = mean(PER, na.rm = T), aGR = mean(GR, na.rm = T), aUSG = mean(USG., na.rm = T), aOWS = mean(OWS, na.rm = T), aDWS = mean(DWS, na.rm = T), aVORP = mean(VORP, na.rm = T))
  return(ret)
}


era1pavgs <- get_player_avgs(era1)
era2pavgs <- get_player_avgs(era2)
era3pavgs <- get_player_avgs(era3)
era4pavgs <- get_player_avgs(era4)
era5pavgs <- get_player_avgs(era5)
era6pavgs <- get_player_avgs(era6)
szn_statspavgs <- get_player_avgs(szn_stats)
szn_statspavgs <- szn_statspavgs[-1, ]
```

```{r}
#got rid of all players that do not have a PPG above or at the 95th percentile since it is reasonable to expect a potential GOAT to score at a high level
get_rid_of_bums <- function(df){
  tmp <- df[df$aPPG >= quantile(df$aPPG, prob= 0.95), ]
  return(tmp)
}

era1nb <- get_rid_of_bums(era1pavgs)
era2nb <- get_rid_of_bums(era2pavgs)
era3nb <- get_rid_of_bums(era3pavgs)
era4nb <- get_rid_of_bums(era4pavgs)
era5nb <- get_rid_of_bums(era5pavgs)
era6nb <- get_rid_of_bums(era6pavgs)
szn_statsnb <- get_rid_of_bums(szn_statspavgs)
szn_statsnb[which(szn_statsnb$aGR == max(szn_statsnb$aGR)), ]
```

```{r}
#to put to rest: do different eras have different levels of competition? pair with ANOVA to answer this 
boxplot(era1nb$aGR, era2nb$aGR, era3nb$aGR, era4nb$aGR, era5nb$aGR, era6nb$aGR, main ="GOAT Rating by Era", names = c("1950-1965", "1966-1980", "1981-1990", "1991-2000", "2001-2010", "2011-2017"), las = 2)

#boxplot(era1nb$aPPG, era2nb$aPPG, era3nb$aPPG, era4nb$aPPG, era5nb$aPPG, era6nb$aPPG, main ="PPG")
#boxplot(era1nb$aAPG, era2nb$aAPG, era3nb$aAPG, era4nb$aAPG, era5nb$aAPG, era6nb$aAPG, main = "APG")
#boxplot(era1nb$aTPG, era2nb$aTPG, era3nb$aTPG, era4nb$aTPG, era5nb$aTPG, era6nb$aTPG, main = "TPG")
#boxplot(era1nb$aBPG, era2nb$aBPG, era3nb$aBPG, era4nb$aBPG, era5nb$aBPG, era6nb$aBPG, main = "BPG")
#boxplot(era1nb$aORPG, era2nb$aORPG, era3nb$aORPG, era4nb$aORPG, era5nb$aORPG, era6nb$aORPG, main = "ORPG")
#boxplot(era1nb$aDRPG, era2nb$aDRPG, era3nb$aDRPG, era4nb$aDRPG, era5nb$aDRPG, era6nb$aDRPG, main = "DRPG")
#boxplot(era1nb$aTSP, era2nb$aTSP, era3nb$aTSP, era4nb$aTSP, era5nb$aTSP, era6nb$aTSP, main = "TSP")
#boxplot(era1nb$aPER, era2nb$aPER, era3nb$aPER, era4nb$aPER, era5nb$aPER, era6nb$aPER, main = "PER")
```

```{r}
#use t test to see whether the Lakers or the Celtics have had better players over the years by GR to see which is the better franchise since they have won the same number of championships

szn_statsBOS <- szn_stats[which(szn_stats$Tm == "BOS"),]

szn_statsLAL <- szn_stats[which(szn_stats$Tm == "LAL"),]

szn_statsBOS <- get_player_avgs(szn_statsBOS)

szn_statsLAL <- get_player_avgs(szn_statsLAL)

szn_statsBOS$Team <- "BOS"
szn_statsLAL$Team <- "LAL"

szn_statsBOSLAL <- rbind(szn_statsBOS, szn_statsLAL)

test1 <- t.test(aGR ~ Team, data = szn_statsBOSLAL)
tapply(szn_statsBOSLAL$aGR, szn_statsBOSLAL$Team, mean)
test1$conf.int 
test1$p.value

#fail to reject the null that the difference in mean GRs of BOS and LAL is zero with a alpha of 0.05. conclusion: there is no significant difference therefore the teams are the same level of greatness.
```


```{r}



szn_stats_gr[is.na(szn_stats)] = 0 

szn_stats$GR <- szn_stats_gr$GR
szn_stats_gr$GR <- (2.0 *szn_stats_gr$PPG) + ((4/5)*szn_stats_gr$DRPG) + szn_stats_gr$ORPG + (1.5 * szn_stats_gr$APG) - (1.5 *szn_stats_gr$TPG) + szn_stats_gr$BPG + (10.0 * szn_stats_gr$TS.)


#test23 <- get_player_avgs(szn_stats_gr)
#test69 <- get_rid_of_bums(test23)
#plot(test23$aGR, test23$aPPG)
#max(test69$aGR)
#test69[which(test69$aGR == max(test69$aGR)),]
#test69[which(test69$aPPG == max(test69$aPPG)),]
#szn_stats[which(szn_stats$GR == max(szn_stats$GR)), ]
```


```{r}
#bootstrapping the correlations between each advanced stat variable and GOAT Rating(GR)

N <- nrow(szn_statsnb)

n_samp <- 10000

corResultsPER <- rep(NA, n_samp)
corResultsVORP <- rep(NA, n_samp)
corResultsOWS <- rep(NA, n_samp)
corResultsDWS <- rep(NA, n_samp)
corResultsUSG <- rep(NA, n_samp)

for(i in 1:n_samp){
  
  s <- sample(1:N, N , replace = T)
  fakeData <-  szn_statsnb[s, ]
    
  corResultsPER[i] <- cor(fakeData[, 10], fakeData[, 9], use = "pairwise.complete.obs")
  corResultsVORP[i] <- cor(fakeData[, 10], fakeData[, 14], use = "pairwise.complete.obs")
  corResultsOWS[i] <- cor(fakeData[, 10], fakeData[, 12], use = "pairwise.complete.obs")
  corResultsDWS[i] <- cor(fakeData[, 10], fakeData[, 13], use = "pairwise.complete.obs")
  corResultsUSG[i] <- cor(fakeData[, 10], fakeData[, 11], use = "pairwise.complete.obs")

}


#performing the correlations between each variable and GOAT rating(GR) in szn_statspavgs
print("Correlation between PER and GR")
cor(szn_statsnb$aPER, szn_statsnb$aGR, use = "pairwise.complete.obs")
print("Correlation between VORP and GR")
cor(szn_statsnb$aVORP, szn_statsnb$aGR, use = "pairwise.complete.obs")
print("Correlation between OWS and GR")
cor(szn_statsnb$aOWS, szn_statsnb$aGR, use = "pairwise.complete.obs")
print("Correlation between DWS and GR")
cor(szn_statsnb$aDWS, szn_statsnb$aGR, use = "pairwise.complete.obs")
print("Correlation between USG and GR")
cor(szn_statsnb$aUSG, szn_statsnb$aGR, use = "pairwise.complete.obs")

#histograms of bootstrapped correlations with confidence intervals
ci_rPER <- quantile(corResultsPER, c(.025, .975))
hist(corResultsPER, col = "blue", main = "Bootstrapped PER Correlations", xlab = "Sample Correlation", breaks = 50)

abline(v = ci_rPER, lwd = 3, col = "red")
abline(v = cor.test(szn_statsnb$aGR, szn_statsnb$aPER)$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft", c("Theoretical CI","Boot CI"), lwd = 3, col = c("green","red"), lty = c(2, 1))


ci_rVORP <- quantile(corResultsVORP, c(.025, .975))
hist(corResultsVORP, col = "blue", main = "Bootstrapped VORP Correlations", xlab = "Sample Correlation", breaks = 50)

abline(v = ci_rVORP, lwd = 3, col = "red")
abline(v = cor.test(szn_statsnb$aGR, szn_statsnb$aVORP)$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft", c("Theoretical CI","Boot CI"), lwd = 3, col = c("green","red"), lty = c(2, 1))


ci_rOWS <- quantile(corResultsOWS, c(.025, .975))
hist(corResultsOWS, col = "blue", main = "Bootstrapped OWS Correlations", xlab = "Sample Correlation", breaks = 50)

abline(v = ci_rOWS, lwd = 3, col = "red")
abline(v = cor.test(szn_statsnb$aGR, szn_statsnb$aOWS)$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft", c("Theoretical CI","Boot CI"), lwd = 3, col = c("green","red"), lty = c(2, 1))


ci_rDWS <- quantile(corResultsDWS, c(.025, .975))
hist(corResultsDWS, col = "blue", main = "Bootstrapped DWS Correlations", xlab = "Sample Correlation", breaks = 50)

abline(v = ci_rDWS, lwd = 3, col = "red")
abline(v = cor.test(szn_statsnb$aGR, szn_statsnb$aDWS)$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft", c("Theoretical CI","Boot CI"), lwd = 3, col = c("green","red"), lty = c(2, 1))


ci_rUSG <- quantile(corResultsUSG, c(.025, .975))
hist(corResultsUSG, col = "blue", main = "Bootstrapped USG Correlations", xlab = "Sample Correlation", breaks = 50)

abline(v = ci_rUSG, lwd = 3, col = "red")
abline(v = cor.test(szn_statsnb$aGR, szn_statsnb$aUSG)$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft", c("Theoretical CI","Boot CI"), lwd = 3, col = c("green","red"), lty = c(2, 1))


```


```{r}

#player compared to era


szn_stats


era_1 <- szn_stats[szn_stats$Year <= 1965, ]
era_1 <- era_1[!is.na(era_1$PER), ]

era_1_russell <- era_1[era_1$Player == "Bill Russell*",]
era_1_notrussell <- era_1[era_1$Player != "Bill Russell*",]

era_1_russell_gr <- mean(era_1_russell$GR)

era_1_notrussell_gr <- mean(era_1_notrussell$GR)


russel_compared_to_rest <- era_1_russell_gr/era_1_notrussell_gr


era_2 <- szn_stats[szn_stats$Year > 1965 & szn_stats$Year <= 1980 ,]

era_2_wilt <-  era_2[era_2$Player == "Wilt Chamberlain*",]
era_2_notwilt <- era_2[era_2$Player != "Wilt Chamberlain*",]

era_2_wilt_gr <- mean(era_2_wilt$GR)

era_2_notwilt_gr <- mean(era_2_notwilt$GR)

wilt_compared_to_rest <- era_2_wilt_gr/era_2_notwilt_gr




era_2_kareem <-  era_2[era_2$Player == "Kareem Abdul-Jabbar*",]
era_2_notkareem <- era_2[era_2$Player != "Kareem Abdul-Jabbar*",]

era_2_kareem_gr <- mean(era_2_kareem$GR)

era_2_notkareem_gr <- mean(era_2_notkareem$GR)

kareem_compared_to_rest <- era_2_kareem_gr/era_2_notkareem_gr


era_3 <- szn_stats[szn_stats$Year > 1980 & szn_stats$Year <= 1990 ,]

era_3_magic <- era_3[era_3$Player == "Magic Johnson*",]
era_3_notmagic <- era_3[era_3$Player != "Magic Johnson*",]

era_3_magic_gr <- mean(era_3_magic$GR)

era_3_notmagic_gr <- mean(era_3_notmagic$GR)

magic_compared_to_rest <- era_3_magic_gr/era_3_notmagic_gr


era_3_bird <- era_3[era_3$Player == "Larry Bird*",]
era_3_notbird <- era_3[era_3$Player != "Larry Bird*",]

era_3_bird_gr <- mean(era_3_bird$GR)

era_3_notbird_gr <- mean(era_3_notbird$GR)

bird_compared_to_rest <- era_3_bird_gr/era_3_notbird_gr


era_4 <- szn_stats[szn_stats$Year > 1990 & szn_stats$Year <= 2000 ,]

era_4_mj <-  era_4[era_4$Player == "Michael Jordan*",]
era_4_notmj <- era_4[era_4$Player != "Michael Jordan*",]

era_4_mj_gr <- mean(era_4_mj$GR)

era_4_notmj_gr <- mean(era_4_notmj$GR)

mj_compared_to_rest <- era_4_mj_gr/era_4_notmj_gr


era_4_shaq <-  era_4[era_4$Player == "Shaquille O'Neal*",]
era_4_notshaq <- era_4[era_4$Player != "Shaquille O'Neal*",]

era_4_shaq_gr <- mean(era_4_shaq$GR)

era_4_notshaq_gr <- mean(era_4_notshaq$GR)

shaq_compared_to_rest <- era_4_shaq_gr/era_4_notshaq_gr


era_5 <- szn_stats[szn_stats$Year > 2000 & szn_stats$Year <= 2010 ,]

era_5_td <-  era_5[era_5$Player == "Tim Duncan",]
era_5_nottd <- era_5[era_5$Player != "Tim Duncan",]

era_5_td_gr <- mean(era_5_td$GR)

era_5_nottd_gr <- mean(era_5_nottd$GR)

td_compared_to_rest <- era_5_td_gr/era_5_nottd_gr

era_5_kobe <-  era_5[era_5$Player == "Kobe Bryant",]
era_5_notkobe <- era_5[era_5$Player != "Kobe Bryant",]

era_5_kobe_gr <- mean(era_5_kobe$GR)

era_5_notkobe_gr <- mean(era_5_notkobe$GR)

kobe_compared_to_rest <- era_5_kobe_gr/era_5_notkobe_gr


era_6 <- szn_stats[szn_stats$Year > 2010,]

era_6_lbj <-  era_5[era_5$Player == "LeBron James",]
era_6_notlbj <- era_5[era_5$Player != "LeBron James",]

era_6_lbj_gr <- mean(era_6_lbj$GR)

era_6_notlbj_gr <- mean(era_6_notlbj$GR)

lbj_compared_to_rest <- era_6_lbj_gr/era_6_notlbj_gr




#scatterplots plotting each variable versus GR

myCor <- function(x, y, w, z){
  #make the scatterplot
  plot(x, y, pch = 19, col = "red", xlab = w, ylab = z)
  #add text in the margin reporting the sample correlation)
  mtext(paste("Sample Correlation =", round(cor(x, y, use = "pairwise.complete.obs"), 3)), cex = 1.2)
}

#myCor(szn_statspavgs$aPPG, szn_statspavgs$aGR, "PPG", "GR")
#myCor(szn_statspavgs$aAPG, szn_statspavgs$aGR, "APG", "GR")
#myCor(szn_statspavgs$aDRPG, szn_statspavgs$aGR, "DRPG", "GR")
#myCor(szn_statspavgs$aORPG, szn_statspavgs$aGR, "ORPG", "GR")
#myCor(szn_statspavgs$aTSP, szn_statspavgs$aGR, "TSP", "GR")
#myCor(szn_statspavgs$aTPG, szn_statspavgs$aGR, "TPG", "GR")
#myCor(szn_statspavgs$aPER, szn_statspavgs$aGR, "PER", "GR")
#myCor(szn_statspavgs$aBPG, szn_statspavgs$aGR, "BPG", "GR")

myCor(szn_statsnb$aPER, szn_statsnb$aGR, "PER", "GR")
myCor(szn_statsnb$aOWS, szn_statsnb$aGR, "OWS", "GR")
myCor(szn_statsnb$aDWS, szn_statsnb$aGR, "DWS", "GR")
myCor(szn_statsnb$aVORP, szn_statsnb$aGR, "VORP", "GR")
myCor(szn_statsnb$aUSG, szn_statsnb$aGR, "USG", "GR")


```

```{r}
#Potential GOATs ordered in descending GOAT Rating

goatorder <- szn_statsnb %>% arrange(desc(aGR))
goatorder <- goatorder[, c(1, 10)]
goatorder
```



```{r}
#multiple regression

#get version of szn_statsnb that only has complete cases. reorder so that GR is first column
szn_statsnb2 <- szn_statsnb[complete.cases(szn_statsnb), ]
szn_statsnb2 <- szn_statsnb2[,-1]
szn_statsnb2 <- szn_statsnb2[, c(9, 8, 10, 11, 12, 13)]
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")

pairsJDRS(szn_statsnb2)
#some evidence of multicolinearity between the variables present. VORP is correlated to DWS, OWS, and PER. PER is correlated to all other variables. Perhaps we should delete VORP and PER?
```


```{r}
#make a model using all predictors

lm1 <- lm(aGR ~ aPER + aVORP + aOWS + aDWS + aUSG, data=szn_statsnb2)
summary(lm1)

myResPlots2(lm1)
```

```{r}
library(leaps)
#use best subsets to find best models

mod1 <- regsubsets(aGR ~ ., data = szn_statsnb2, nvmax = 5)

mod1sum <- summary(mod1)


#find what number of variables give the best model according to BIC
which.min(mod1sum$bic)

#Which variables are in model 4
names(szn_statsnb2)[mod1sum$which[which.min(mod1sum$bic), ]][-1]

#Fit this model and show results
temp <- szn_statsnb2[,mod1sum$which[which.min(mod1sum$bic), ]]
summary(lm(aGR ~ ., data = temp))
```


```{r}
#try to fit a model without VORP and PER to see if that helps get rid of multicollinearity

#get version of szn_statsnb that only has complete cases. reorder so that GR is first column
szn_statsnb3 <- szn_statsnb[complete.cases(szn_statsnb), ]
szn_statsnb3 <- szn_statsnb3[,-1]
szn_statsnb3 <- szn_statsnb3[, c(9, 10, 11, 12)]
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")

pairsJDRS(szn_statsnb3)
#less evidence of multicollinearity now

```

```{r}
lm2 <- lm(aGR ~ aOWS + aDWS + aUSG, data=szn_statsnb3)
summary(lm2)

myResPlots2(lm2)
```

```{r}
mod2 <- regsubsets(aGR ~ ., data = szn_statsnb3, nvmax = 3)

mod2sum <- summary(mod2)

which.min(mod2sum$bic)

#since all variables are in this, it is the same as the original model
names(szn_statsnb3)[mod2sum$which[which.min(mod2sum$bic), ]][-1]

```


```{r}
#Permutation tests on TS and PER between season stats before 1980 and season stats after 1980
set.seed(230)
avgdiff <- vector(10000, mode = "numeric")

actualdiff <- mean(szn_stats$PER[szn_stats$Year <= 1980]) - mean(szn_stats$PER[szn_stats$Year > 1980 ])

for(i in 1:10000){
  fakeyear <- sample(szn_stats$Year)
  avgdiff[i] <- mean(szn_stats$PER[fakeyear <= 1980]) - mean(szn_stats$PER[fakeyear > 1980 ])
  
}

#Add something to make the abline show
hist(avgdiff, col= "blue")
abline(v= actualdiff, col = "green", lwd = 3)
actualdiff
```

```{r}
#Permutation tests continued
set.seed(230)
avgdiff <- vector(10000, mode = "numeric")

actualdiff <- mean(szn_stats$TS.[szn_stats$Year <= 1980] *100) - mean(szn_stats$TS.[szn_stats$Year > 1980 ]*100)

for(i in 1:10000){
  fakeyear <- sample(szn_stats$Year)
  avgdiff[i] <- mean(szn_stats$TS.[fakeyear <= 1980]*100) - mean(szn_stats$TS.[fakeyear > 1980 ]*100)
  
}

#Add something to make the abline show
hist(avgdiff, col= "blue")
abline(v= actualdiff, col = "green", lwd = 3)
actualdiff

```

```{r}
#standard deviation


russel_sd <- (era_1_russell_gr - mean(era1$GR))/sd(era1$GR) 
wilt_sd <- (era_2_wilt_gr - mean(era2$GR))/sd(era2$GR) 

kareem_sd <- (era_2_kareem_gr - mean(era2$GR))/sd(era2$GR) 

magic_sd <- (era_3_magic_gr - mean(era3$GR))/sd(era3$GR)

bird_sd <- (era_3_bird_gr - mean(era3$GR))/sd(era3$GR)

mj_sd <- (era_4_mj_gr - mean(era4$GR))/sd(era4$GR)

shaq_sd <- (era_4_shaq_gr - mean(era4$GR))/sd(era4$GR)

td_sd <- (era_5_td_gr - mean(era5$GR))/sd(era5$GR)

kobe_sd <- (era_5_kobe_gr - mean(era5$GR))/sd(era5$GR)

lbj_sd <- (era_6_lbj_gr - mean(era6$GR))/sd(era6$GR)
```

```{r}
alleras_nb <- get_rid_of_bums(alleras)

alleras_nb$era <- factor(alleras_nb$era, labels = c("1", "2", "3", "4", "5", "6"))

aov1 <- aov(aGR ~ era, data = alleras_nb)

summary(aov1)

TukeyHSD(aov1)

# Gives SIMULTANEOUS 95% CI's for the 10 differences in means.
plot(TukeyHSD(aov1))

#Fix axes
plot(TukeyHSD(aov1), las = 1)

```

